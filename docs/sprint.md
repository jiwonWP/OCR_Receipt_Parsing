# OCR 파싱 과제 — Sprint 계획

OCR 노이즈 환경을 전제로,  
**Robustness → Accuracy → Engineering Quality → Reasoning** 순으로 점진적으로 완성하는 것을 목표로 진행합니다.

---

## Sprint 1 — 데이터 분석 및 설계 고정

### 목표
- OCR 데이터의 노이즈 특성을 전수 분석하고  
- 전체 파이프라인과 출력 스키마, 검증 정책을 **문서로 고정**

### 주요 작업
- 제공된 4개 샘플 JSON의 `text` 필드 전수 분석
  - 날짜/시간/무게/라벨의 표현 방식 정리
  - 띄어쓰기 오류, 오탈자, 라벨 누락, 숫자 포맷 깨짐 등 노이즈 유형 분류
- OCR 노이즈 분류표 작성
- 출력 데이터 스키마(MVP) 정의
  - 필수 필드 vs 선택 필드 구분
- 도메인 검증 정책 초안 정의
  - 총중량 ≥ 공차중량
  - 실중량 ≈ 총중량 − 공차중량
- 파이프라인 아키텍처 설계
  - Loader → Preprocessor → Extractor → Normalizer → Validator → Exporter

### 산출물
- `docs/DESIGN.md` 초안
- Noise 분류 표
- 출력 스키마 정의

---

## Sprint 2 — 데이터 로드 및 텍스트 전처리

### 목표
- OCR 원문을 **분석 가능한 정규화 텍스트**로 변환
- 이후 단계가 “노이즈를 신경 쓰지 않고” 동작할 수 있는 방어막 구축

### 주요 작업
- JSON Loader 구현
  - zip 내부 JSON 파일 로드
  - `text` 필드 추출 및 예외 처리
- 텍스트 전처리 로직 구현
  - 공백/줄바꿈/특수문자 정리
  - 띄어쓰기 깨진 라벨 정규화  
    (예: `총 중 량` → `총중량`)
  - 업무 라벨 중심의 오타/깨짐 치환(Fuzzy Keyword Map)
- 의미 없는 라인 제거 기준 정의
- 전처리 전/후 라인 수 및 치환 결과 로깅

### 산출물
- `loader.py`
- `preprocess.py`
- 기본 로깅 시스템
- 전처리 결과를 콘솔로 확인 가능

---

## Sprint 3 — 핵심 필드 추출

### 목표
- 값을 확정하지 않고, **후보를 최대한 안정적으로 수집**

### 주요 작업
- 정규식 패턴 정의
  - 날짜, 시간, 무게(kg), 차량번호 등
- Candidate 모델 정의
  - 값, 근거 라인, 추출 방식(label / pattern) 기록
- 라벨 기반 추출
  - `총중량`, `공차중량`, `실중량`, `날짜` 등 기준
- 패턴 기반 추출
  - 라벨 누락/순서 변경 대비
- 후보 점수(score) 또는 우선순위 기준 설계
- 샘플별 후보 개수 및 근거 라인 디버깅 출력

### 산출물
- `patterns.py`
- `extractors.py`
- 후보 기반 추출 결과 확인 로그

---

## Sprint 4 — 데이터 정규화 및 도메인 검증 

### 목표
- 문자열 후보를 **의미 있는 타입(int/date)** 으로 변환하고
- 비즈니스 관점에서 **타당성 검증 및 최종 확정**

### 주요 작업
- 정규화 로직 구현
  - 무게: 공백/쉼표 제거 → int
  - 날짜: ISO 포맷 변환 및 꼬리 제거
  - 시간: `(09:09)`, `11시 33분` 정규화
- 후보 선택(Resolver) 로직 구현
  - 라벨 기반 후보 우선
- 도메인 검증 로직 구현
  - 총중량 ≥ 공차중량
  - 실중량 검증 및 계산 대체 정책
- 실패 정책 설계
  - invalid 처리 + 이유 기록
  - `parse_warnings` / `validation_errors` 분리

### 산출물
- `normalizers.py`
- `validators.py`
- 최종 `ParseResult` 생성

---

## Sprint 5 — 리팩토링 및 테스트 

### 목표
- “돌아가는 코드”를 **유지보수 가능한 제품 수준 코드**로 정리

### 주요 작업
- 모듈 책임 재정렬 및 중복 제거
- 패턴/라벨/정책 상수화
- 핵심 로직 단위 테스트 작성
  - 무게/날짜/시간 정규화
  - 도메인 검증 로직
- 결과 파일(JSON/CSV) 출력 고정
- CLI 실행 흐름 안정화

### 산출물
- `tests/` 디렉토리 및 테스트 코드
- `outputs/parsed_sample_01~04.json`
- 단일 커맨드 실행 가능 상태

---

## Sprint 6 — 문서화 및 최종 패키징 

### 목표
- 사고 과정과 설계 의도를 **문서로 명확히 전달**

### 주요 작업
- README.md 완성
  - 문제 이해
  - 노이즈 대응 전략
  - 아키텍처
  - 정규화/검증 정책
  - 실행 방법
  - 한계 및 개선 방향
- DESIGN.md 보완
- 새 환경에서 재현성 최종 점검
- 제출 파일 구성 및 메일 발송 준비

### 산출물
- `README.md` (완성본)
- `docs/DESIGN.md`
- 제출용 패키지(zip)

---